<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{{ page.title }} – WECON USA</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="icon" href="{{ site.baseurl }}/img/favicon.ico">
  <link rel="stylesheet" href="{{ site.baseurl }}/css/site.css">
  {% include analytics.html %}
  <style>
    /* Minimal gallery styles, keeps existing site.css intact */
    .product-gallery { display: grid; gap: 12px; }
    .product-main img { max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
    .product-thumbs { display: flex; flex-wrap: wrap; gap: 8px; }
    .product-thumbs .thumb { border: 2px solid transparent; padding: 0; background: none; border-radius: 6px; cursor: pointer; }
    .product-thumbs .thumb.is-active { border-color: #2563eb; }
    .product-thumbs img { width: 84px; height: 64px; object-fit: cover; border-radius: 4px; display: block; }
  </style>
</head>
<body>
  <header class="topbar container">
    <a href="{{ site.baseurl }}/" class="brand">
      <img src="{{ site.baseurl }}/img/wecon-logo.svg" alt="Wecon" class="logo">
    </a>
    <nav class="nav">
      <a href="{{ site.baseurl }}/#products">Products</a>
      <a href="{{ site.baseurl }}/#shipping">Shipping</a>
      <a href="{{ site.baseurl }}/#contact">Contact</a>
      <a href="https://www.ebay.com/usr/wecon-usa" target="_blank" rel="noopener">eBay</a>
    </nav>
  </header>

  <main class="container">
    <h1>{{ page.title }}</h1>
    <p><strong>${{ page.price }}</strong>{% if page.stock %} · In stock: {{ page.stock }}{% endif %}</p>

    {%- comment -%} Determine main image (first of images[], else image) {%- endcomment -%}
    {%- assign has_images = page.images and page.images.size and page.images.size > 0 -%}
    {%- if has_images -%}
      {%- assign main_image = page.images[0] -%}
    {%- else -%}
      {%- assign main_image = page.image -%}
    {%- endif -%}

    {% if main_image %}
    <div class="product-gallery">
      <div class="product-main">
        <img id="product-main" src="{{ site.baseurl }}{{ main_image }}" alt="{{ page.title }}" loading="lazy">
      </div>
      {% if has_images and page.images.size > 1 %}
      <div class="product-thumbs" aria-label="Image thumbnails">
        {% for img in page.images %}
          <button class="thumb{% if forloop.first %} is-active{% endif %}" type="button" data-src="{{ site.baseurl }}{{ img }}">
            <img src="{{ site.baseurl }}{{ img }}" alt="{{ page.title }} thumbnail {{ forloop.index }}">
          </button>
        {% endfor %}
      </div>
      {% endif %}
    </div>
    {% endif %}

    {% if page.specs %}
      <h3>Specs</h3>
      {% if page.specs.size %}
        <ul>
          {% for s in page.specs %}
            <li>{{ s | strip }}</li>
          {% endfor %}
        </ul>
      {% else %}
        {% assign specs_list = page.specs | split: ',' %}
        <ul>
          {% for s in specs_list %}
            <li>{{ s | strip }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endif %}

    <p class="btn-row">
      <a class="btn" href="mailto:sales@wecon-usa.com?subject=Quote%20for%20{{ page.sku | uri_escape }}">Request invoice</a>
      <a class="btn" href="https://www.ebay.com/usr/wecon-usa" target="_blank" rel="noopener">eBay</a>
    </p>

    {{ content }}
  </main>

  <footer class="footer">
    © {{ site.time | date: "%Y" }} Wecon America LLC
  </footer>

  <script>
    // Simple gallery script: swap main image when a thumbnail is clicked
    document.addEventListener('click', function (e) {
      const btn = e.target.closest('.product-thumbs .thumb');
      if (!btn) return;
      const main = document.getElementById('product-main');
      if (!main) return;
      const src = btn.getAttribute('data-src');
      if (src) {
        main.src = src;
        const active = btn.parentElement.querySelector('.thumb.is-active');
        if (active) active.classList.remove('is-active');
        btn.classList.add('is-active');
      }
    });
  </script>
</body>
</html>
